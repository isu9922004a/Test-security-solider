<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è»äº‹æº–å‰‡ - å…¨çœŸæ¨¡æ“¬é‘‘æ¸¬ç³»çµ±</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* é ‚éƒ¨å°èˆª */
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .brand {
            font-size: 1.2rem;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .timer-box {
            background: rgba(0,0,0,0.3);
            padding: 5px 15px;
            border-radius: 20px;
            font-family: monospace;
            font-size: 1.2rem;
            font-weight: bold;
            display: none; /* è€ƒè©¦é–‹å§‹æ‰é¡¯ç¤º */
        }

        .timer-box.urgent {
            background-color: var(--accent);
            animation: pulse 1s infinite;
        }

        /* ä¸»è¦å®¹å™¨ */
        main {
            flex: 1;
            max-width: 800px;
            margin: 20px auto;
            width: 95%;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            padding: 30px;
            position: relative;
        }

        /* æ­¡è¿/é–‹å§‹ç•«é¢ */
        .screen {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        
        .screen.active {
            display: block;
        }

        h2 { border-bottom: 2px solid var(--accent); padding-bottom: 10px; margin-top: 0; }
        
        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.2s;
            font-weight: bold;
        }

        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .btn-lg { width: 100%; margin-top: 20px; font-size: 1.1rem; }
        .btn-secondary { background-color: #95a5a6; }

        /* è€ƒè©¦ä»‹é¢ */
        .progress-bar {
            height: 6px;
            background: #eee;
            margin-bottom: 20px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--success);
            width: 0%;
            transition: width 0.3s;
        }

        .question-card {
            margin-bottom: 20px;
        }

        .q-tag {
            background: var(--light);
            color: var(--secondary);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-bottom: 10px;
            display: inline-block;
        }

        .q-text {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        textarea {
            width: 100%;
            height: 100px;
            padding: 15px;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            resize: none;
            box-sizing: border-box;
            transition: 0.3s;
        }

        textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(44, 62, 80, 0.1);
        }

        /* çµæœé é¢ */
        .score-display {
            text-align: center;
            padding: 30px;
            background: var(--light);
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .final-score {
            font-size: 4rem;
            font-weight: bold;
            color: var(--primary);
            line-height: 1;
        }

        .score-label { color: #7f8c8d; }

        .review-item {
            border-bottom: 1px solid #eee;
            padding: 15px 0;
        }

        .review-q { font-weight: bold; color: #555; margin-bottom: 5px; }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.95rem;
        }

        .user-ans { color: var(--accent); background: #fdeaea; padding: 8px; border-radius: 4px; }
        .correct-ans { color: var(--success); background: #eafaf1; padding: 8px; border-radius: 4px; }
        
        .memory-tip {
            margin-top: 5px;
            font-size: 0.85rem;
            color: #d35400;
            background: #fff5e6;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
        }

        .status-badge {
            float: right;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            color: white;
        }
        .bg-perfect { background-color: var(--success); }
        .bg-ok { background-color: var(--warning); }
        .bg-fail { background-color: var(--accent); }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 600px) {
            .comparison { grid-template-columns: 1fr; }
            main { padding: 20px; width: 90%; }
            .final-score { font-size: 3rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="brand">ğŸ›¡ï¸ æº–å‰‡é‘‘æ¸¬ä¸­å¿ƒ</div>
        <div class="timer-box" id="timer">10:00</div>
    </header>

    <main>
        <!-- 1. é–‹å§‹ç•«é¢ -->
        <div id="screen-start" class="screen active">
            <h2>è€ƒè©¦è¦å‰‡èªªæ˜</h2>
            <p>æ­¡è¿é€²å…¥æ¨¡æ“¬é‘‘æ¸¬ç³»çµ±ï¼Œè«‹é–±è®€ä»¥ä¸‹è¦å‰‡ï¼š</p>
            <ul>
                <li><strong>è€ƒè©¦æ™‚é–“ï¼š</strong>10 åˆ†é˜ã€‚</li>
                <li><strong>è©•åˆ†æ¨™æº–ï¼š</strong>ç³»çµ±å°‡è‡ªå‹•æ¯”å°é—œéµå­—èˆ‡å®Œæ•´åº¦ã€‚éŒ¯å­—æˆ–æ¼å­—æœƒä¾æ¯”ä¾‹æ‰£åˆ†ã€‚</li>
                <li><strong>é¡Œå‹ï¼š</strong>åŒ…å«å¡«ç©ºèˆ‡ç°¡ç­”ï¼Œè«‹æ†‘è¨˜æ†¶ç›¡é‡è¼¸å…¥å®Œæ•´æ¢æ–‡ã€‚</li>
            </ul>
            
            <div style="margin: 20px 0; background: #f8f9fa; padding: 15px; border-radius: 5px;">
                <label><strong>é¸æ“‡è€ƒé¡Œç¯„åœï¼š</strong></label>
                <select id="exam-scope" style="padding: 8px; width: 100%; margin-top: 10px;">
                    <option value="all">å…¨éƒ¨æ··å’Œ (éš¨æ©Ÿ 10 é¡Œ)</option>
                    <option value="sentry">åƒ…æ¸¬é©—ï¼šè¡›å“¨å®ˆå‰‡ (8é¡Œ)</option>
                    <option value="safety">åƒ…æ¸¬é©—ï¼šå®‰å®˜å®ˆå‰‡ (8é¡Œ)</option>
                    <option value="gun">åƒ…æ¸¬é©—ï¼šç”¨æ§æ™‚æ©Ÿèˆ‡è¦é ˜ (10é¡Œ)</option>
                </select>
            </div>

            <button class="btn btn-lg" onclick="startExam()">é–‹å§‹æ¸¬é©—</button>
        </div>

        <!-- 2. è€ƒè©¦ç•«é¢ -->
        <div id="screen-exam" class="screen">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            
            <div class="question-card">
                <span class="q-tag" id="q-category">é¡åˆ¥</span>
                <div class="q-text" id="q-text">é¡Œç›®å…§å®¹è¼‰å…¥ä¸­...</div>
                <textarea id="user-input" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ¢æ–‡å…§å®¹..." onkeydown="handleEnter(event)"></textarea>
            </div>

            <div style="display: flex; justify-content: space-between;">
                <span style="color: #999; font-size: 0.9rem;">æŒ‰ Enter éµä¹Ÿå¯é€å‡º</span>
                <button class="btn" onclick="submitAnswer()">ä¸‹ä¸€é¡Œ â”</button>
            </div>
        </div>

        <!-- 3. çµæœç•«é¢ -->
        <div id="screen-result" class="screen">
            <h2>æ¸¬é©—æˆç¸¾å–®</h2>
            
            <div class="score-display">
                <div class="final-score" id="final-score">0</div>
                <div class="score-label">ç¸½åˆ† (æ»¿åˆ† 100)</div>
                <div id="comment" style="margin-top: 10px; font-weight: bold; color: var(--primary);"></div>
            </div>

            <h3>è©³ç´°æª¢è¨</h3>
            <div id="review-list">
                <!-- æª¢è¨å…§å®¹ç”± JS ç”Ÿæˆ -->
            </div>

            <button class="btn btn-lg" onclick="location.reload()">é‡æ–°æ¸¬é©—</button>
        </div>
    </main>

    <script>
        // è³‡æ–™åº«
        const fullDB = [
            { cat: "è¡›å“¨å®ˆå‰‡", id: 1, q: "ç¬¬ 1 æ¢", a: "æœè£æ•´é½Šé…ä»¶å…‰äº®", h: "é‘½çŸ³è¡£ã€é¡å­è…°å¸¶" },
            { cat: "è¡›å“¨å®ˆå‰‡", id: 2, q: "ç¬¬ 2 æ¢", a: "ç²¾ç¥é£½æ»¿å§¿æ…‹ç«¯æ­£", h: "é‹¼æ¿èƒŒã€è »ç‰›çœ¼" },
            { cat: "è¡›å“¨å®ˆå‰‡", id: 3, q: "ç¬¬ 3 æ¢", a: "æ¢°å½ˆæ”œå¸¶ç¢ºéµè¦å®š", h: "æ‰‹éŠ¬æ§ã€è—æ³¢å½ˆ" },
            { cat: "è¡›å“¨å®ˆå‰‡", id: 4, q: "ç¬¬ 4 æ¢", a: "å …å®ˆå´—ä½åš´å¯†æœæŸ¥", h: "ä¸‰ç§’è† è…³ã€æ”¾å¤§é¡" },
            { cat: "è¡›å“¨å®ˆå‰‡", id: 5, q: "ç¬¬ 5 æ¢", a: "æé«˜è­¦è¦ºæ™‚æ™‚æˆ’å‚™", h: "é›·é”é ­ã€è­¦ç¤ºç‡ˆ" },
            { cat: "è¡›å“¨å®ˆå‰‡", id: 6, q: "ç¬¬ 6 æ¢", a: "ä¸çœ‹ç†±é¬§æ³¨æ„å¯ç–‘", h: "ä¸çœ‹è¾£å¦¹ã€ç›¯é»‘è¡£äºº" },
            { cat: "è¡›å“¨å®ˆå‰‡", id: 7, q: "ç¬¬ 7 æ¢", a: "æœå‹¤èªçœŸèªªè©±å®¢æ°£", h: "ç©ºå§ç¬‘ã€èªçœŸè‡‰" },
            { cat: "è¡›å“¨å®ˆå‰‡", id: 8, q: "ç¬¬ 8 æ¢", a: "åš´æ ¼ç®¡åˆ¶ä»”ç´°æŸ¥é©—", h: "å¤§æŸµæ¬„ã€é¡¯å¾®é¡" },
            
            { cat: "å®‰å®˜å®ˆå‰‡", id: 1, q: "ç¬¬ 1 æ¢", a: "è² è²¬å–®ä½å®‰å…¨", h: "æŠ±è‘—ä¿éšªç®±" },
            { cat: "å®‰å®˜å®ˆå‰‡", id: 2, q: "ç¬¬ 2 æ¢", a: "æ¢°å½ˆæ¸…é»ç®¡åˆ¶", h: "æ•¸å­å½ˆ" },
            { cat: "å®‰å®˜å®ˆå‰‡", id: 3, q: "ç¬¬ 3 æ¢", a: "åš´å¯†æ°´é›»ç®¡åˆ¶", h: "é—œçš®å¡ä¸˜ã€é—œå‚‘å°¼é¾œ" },
            { cat: "å®‰å®˜å®ˆå‰‡", id: 4, q: "ç¬¬ 4 æ¢", a: "æ¸…æŸ¥å°±å¯¢äººæ•¸", h: "ç‰§ç¾Šäººæ•¸ç¾Š" },
            { cat: "å®‰å®˜å®ˆå‰‡", id: 5, q: "ç¬¬ 5 æ¢", a: "å·¡è¦–è¡›å“¨å‹¤å‹™", h: "æœ›é é¡çœ‹è¡›å…µ" },
            { cat: "å®‰å®˜å®ˆå‰‡", id: 6, q: "ç¬¬ 6 æ¢", a: "æ³¨æ„å¯ç–‘äººç‰©", h: "æŠ“å¿è€…" },
            { cat: "å®‰å®˜å®ˆå‰‡", id: 7, q: "ç¬¬ 7 æ¢", a: "æ¥è½æˆ°æƒ…é›»è©±", h: "è­¦å ±é›»è©±" },
            { cat: "å®‰å®˜å®ˆå‰‡", id: 8, q: "ç¬¬ 8 æ¢", a: "åæ˜ ç·Šæ€¥äº‹æ•…", h: "SOSæŒ‰éˆ•" },

            { cat: "ç”¨æ§æ™‚æ©Ÿ", id: 1, q: "ç”Ÿå‘½èº«é«”å—æš´è¡Œè„…è¿«æ™‚...", a: "ç”Ÿå‘½èº«é«”å—æš´è¡Œè„…è¿«ï¼Œéä½¿ç”¨æ­¦å™¨ä¸èƒ½æŠµæŠ—æˆ–è‡ªè¡›æ™‚", h: "æŠµæŠ—ã€è‡ªè¡›" },
            { cat: "ç”¨æ§æ™‚æ©Ÿ", id: 2, q: "ç¾¤çœ¾æš´å‹•æ™‚...", a: "ç¾¤çœ¾æš´å‹•ï¼Œéä½¿ç”¨æ­¦å™¨ä¸èƒ½åˆ¶æ­¢æ™‚", h: "ç¾¤çœ¾æš´å‹•ã€åˆ¶æ­¢" },
            { cat: "ç”¨æ§æ™‚æ©Ÿ", id: 3, q: "æ‰€è­¦è¡›ä¹‹äººå“¡ç‰©è³‡å—å±å®³æ™‚...", a: "æ‰€è­¦è¡›ä¹‹äººå“¡ç‰©è³‡è»Šèˆ¹èˆªç©ºå™¨å—å±å®³è„…è¿«æ™‚ï¼Œéä½¿ç”¨æ­¦å™¨ä¸èƒ½ä¿è­·æ™‚", h: "äººå“¡ç‰©è³‡è»Šèˆ¹èˆªç©ºå™¨ã€ä¿è­·" },
            { cat: "ç”¨æ§æ™‚æ©Ÿ", id: 4, q: "é˜²è¡›é§æ‰€å—è¥²æ“¾æ™‚...", a: "å› é˜²è¡›é§æ‰€ä¹‹åœŸåœ°å ´æ‰€å»ºç¯‰ç‰©å—è¥²æ“¾æˆ–æ“…é—–ï¼Œç¶“è­¦å‘Šä»ä¸è½å¾ï¼Œéä½¿ç”¨æ­¦å™¨è€Œä¸èƒ½åˆ¶æ­¢æ™‚", h: "åœŸåœ°å ´æ‰€å»ºç¯‰ç‰©ã€è¥²æ“¾æ“…é—–ã€ä¸è½å¾" },
            { cat: "ç”¨æ§æ™‚æ©Ÿ", id: 5, q: "è¦çŠ¯é€ƒè„«æ™‚...", a: "è¦çŠ¯é€ƒè„«ï¼Œéä½¿ç”¨æ­¦å™¨ä¸èƒ½åˆ¶æ­¢æ™‚", h: "è¦çŠ¯é€ƒè„«ã€åˆ¶æ­¢" },

            { cat: "ç”¨æ§è¦é ˜", id: 1, q: "å¦‚éæƒ…å‹¢ç•°å¸¸æ€¥è¿«...", a: "å¦‚éæƒ…å‹¢ç•°å¸¸æ€¥è¿«æ‡‰å…ˆå£é ­è­¦å‘Šä¸¦å°ç©ºé³´æ§è­¦å‘Šä¹‹", h: "å£é ­è­¦å‘Šã€å°ç©ºé³´æ§" },
            { cat: "ç”¨æ§è¦é ˜", id: 2, q: "ç¶“è­¦å‘Šå·²æœ‰ç•æœ...", a: "ç¶“è­¦å‘Šå·²æœ‰ç•æœä¹‹æƒ…æ³æ™‚æ‡‰ç«‹å³åœæ­¢ä½¿ç”¨", h: "ç•æœã€åœæ­¢ä½¿ç”¨" },
            { cat: "ç”¨æ§è¦é ˜", id: 3, q: "ä½¿ç”¨æ­¦å™¨æ‡‰æ³¨æ„...", a: "ä½¿ç”¨æ­¦å™¨æ‡‰æ³¨æ„å‹¿å‚·åŠä»–äºº", h: "å‹¿å‚·åŠä»–äºº" },
            { cat: "ç”¨æ§è¦é ˜", id: 4, q: "å¦‚éæƒ…å‹¢ç¢ºæœ‰å¿…è¦...", a: "å¦‚éæƒ…å‹¢ç¢ºæœ‰å¿…è¦æ‡‰å„˜é‡é¿å…å‚·åŠå…¶è‡´å‘½éƒ¨ä½", h: "é¿å…å‚·åŠè‡´å‘½éƒ¨ä½" },
            { cat: "ç”¨æ§è¦é ˜", id: 5, q: "ä½¿ç”¨æ­¦å™¨å¾Œ...", a: "ä½¿ç”¨æ­¦å™¨å¾Œæ‡‰å°‡ç¶“éæƒ…å½¢å³æ™‚å ±å‘Šè©²ç®¡é•·å®˜", h: "å ±å‘Šé•·å®˜" }
        ];

        let currentExam = [];
        let currentIndex = 0;
        let userAnswers = [];
        let timerInterval;
        let timeLeft = 600; // 10åˆ†é˜

        // æ´—ç‰Œæ¼”ç®—æ³•
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // é–‹å§‹è€ƒè©¦
        function startExam() {
            const scope = document.getElementById('exam-scope').value;
            let pool = [];

            if (scope === 'all') {
                pool = [...fullDB];
                shuffle(pool);
                currentExam = pool.slice(0, 10); // éš¨æ©Ÿ 10 é¡Œ
            } else if (scope === 'sentry') {
                currentExam = fullDB.filter(x => x.cat === "è¡›å“¨å®ˆå‰‡");
            } else if (scope === 'safety') {
                currentExam = fullDB.filter(x => x.cat === "å®‰å®˜å®ˆå‰‡");
            } else {
                currentExam = fullDB.filter(x => x.cat.includes("ç”¨æ§"));
            }

            currentIndex = 0;
            userAnswers = [];
            
            document.getElementById('screen-start').classList.remove('active');
            document.getElementById('screen-exam').classList.add('active');
            document.querySelector('.timer-box').style.display = 'block';

            startTimer();
            showQuestion();
        }

        // é¡¯ç¤ºé¡Œç›®
        function showQuestion() {
            const q = currentExam[currentIndex];
            document.getElementById('q-category').innerText = `${q.cat} - ç¬¬ ${q.id} é¡Œ/é»`;
            
            // å¦‚æœæ˜¯çŸ­é¡Œ(è¡›å“¨/å®‰å®˜)ï¼Œç›´æ¥å•å…§å®¹ï¼›å¦‚æœæ˜¯é•·é¡Œ(ç”¨æ§)ï¼Œçµ¦ä¸€é»é–‹é ­æç¤º
            if(q.cat.includes("ç”¨æ§")) {
                document.getElementById('q-text').innerText = `è«‹æ¥çºŒå®Œæˆæ¢æ–‡ï¼š\nã€Œ${q.q}ã€`;
            } else {
                document.getElementById('q-text').innerText = `è«‹è¼¸å…¥å®Œæ•´æ¢æ–‡å…§å®¹ï¼š`;
            }
            
            document.getElementById('user-input').value = "";
            document.getElementById('user-input').focus();
            
            // æ›´æ–°é€²åº¦æ¢
            const pct = (currentIndex / currentExam.length) * 100;
            document.getElementById('progress-fill').style.width = `${pct}%`;
        }

        // è™•ç† Enter éµ
        function handleEnter(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                submitAnswer();
            }
        }

        // æäº¤ç­”æ¡ˆ
        function submitAnswer() {
            const input = document.getElementById('user-input').value.trim();
            userAnswers.push(input);

            currentIndex++;
            if (currentIndex < currentExam.length) {
                showQuestion();
            } else {
                finishExam();
            }
        }

        // è¨ˆæ™‚å™¨
        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                const m = Math.floor(timeLeft / 60);
                const s = timeLeft % 60;
                const display = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
                document.getElementById('timer').innerText = display;

                if (timeLeft <= 60) {
                    document.querySelector('.timer-box').classList.add('urgent');
                }

                if (timeLeft <= 0) {
                    finishExam();
                }
            }, 1000);
        }

        // çµæŸè€ƒè©¦èˆ‡è©•åˆ†
        function finishExam() {
            clearInterval(timerInterval);
            document.getElementById('screen-exam').classList.remove('active');
            document.getElementById('screen-result').classList.add('active');
            document.querySelector('.timer-box').style.display = 'none';

            let totalScore = 0;
            const reviewContainer = document.getElementById('review-list');
            reviewContainer.innerHTML = '';

            currentExam.forEach((q, idx) => {
                const userAns = userAnswers[idx] || "";
                const score = calculateSimilarity(userAns, q.a);
                totalScore += score;

                // ç”¢ç”Ÿæª¢è¨é …ç›®
                let statusClass = score === 100 ? 'bg-perfect' : (score >= 60 ? 'bg-ok' : 'bg-fail');
                let statusText = score === 100 ? 'å®Œç¾' : (score >= 60 ? 'é€šé' : 'éŒ¯èª¤');

                const html = `
                    <div class="review-item">
                        <div class="review-q">
                            ${idx + 1}. ${q.cat} (ç¬¬${q.id}æ¢)
                            <span class="status-badge ${statusClass}">${statusText} (${Math.round(score)}%)</span>
                        </div>
                        <div class="comparison">
                            <div class="user-ans">ä½ çš„ç­”æ¡ˆï¼š${userAns || "(æœªä½œç­”)"}</div>
                            <div class="correct-ans">æ­£ç¢ºç­”æ¡ˆï¼š${q.a}</div>
                        </div>
                        ${score < 100 ? `<div class="memory-tip">ğŸ’¡ è¨˜æ†¶æ›é‰¤ï¼š${q.h}</div>` : ''}
                    </div>
                `;
                reviewContainer.innerHTML += html;
            });

            const finalAvg = Math.round(totalScore / currentExam.length);
            document.getElementById('final-score').innerText = finalAvg;

            const commentEl = document.getElementById('comment');
            if (finalAvg >= 90) commentEl.innerText = "å¤ªç¥äº†ï¼ä½ æ˜¯è¨˜æ†¶å¤©æ‰ï¼";
            else if (finalAvg >= 80) commentEl.innerText = "è¡¨ç¾å„ªç§€ï¼Œå¯ä»¥å»ç•¶æ•™å®˜äº†ï¼";
            else if (finalAvg >= 60) commentEl.innerText = "å‹‰å¼·åŠæ ¼ï¼Œç´°ç¯€è¦å†åŠ å¼·ã€‚";
            else commentEl.innerText = "ä¸åŠæ ¼ï¼æ™šä¸Šä¸ç”¨ç¡äº†ï¼Œç¹¼çºŒèƒŒï¼";
        }

        // ç°¡å–®çš„ç›¸ä¼¼åº¦æ¼”ç®—æ³• (æ¯”å°å­—å…ƒé‡ç–Šç‡)
        function calculateSimilarity(s1, s2) {
            // ç§»é™¤æ¨™é»èˆ‡ç©ºç™½
            const clean1 = s1.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, "");
            const clean2 = s2.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, "");

            if (!clean1) return 0;
            if (clean1 === clean2) return 100;

            // æª¢æŸ¥ clean2 (æ­£ç¢ºç­”æ¡ˆ) çš„æ¯å€‹å­—æ˜¯å¦å‡ºç¾åœ¨ clean1 (ä½¿ç”¨è€…ç­”æ¡ˆ) ä¸­
            let matchCount = 0;
            let tempUser = clean1;
            
            for (let char of clean2) {
                const idx = tempUser.indexOf(char);
                if (idx !== -1) {
                    matchCount++;
                    // ç§»é™¤å·²åŒ¹é…çš„å­—å…ƒï¼Œé¿å…é‡è¤‡è¨ˆç®—
                    tempUser = tempUser.slice(0, idx) + tempUser.slice(idx + 1);
                }
            }

            // è¨ˆç®—åˆ†æ•¸ï¼šåŒ¹é…å­—æ•¸ / æ­£ç¢ºç­”æ¡ˆç¸½å­—æ•¸
            // ç‚ºäº†é¿å…ä½¿ç”¨è€…äº‚æ‰“å¾ˆå¤šå­—ä¾†é¨™åˆ†ï¼Œä¹Ÿè¦è€ƒæ…®é•·åº¦å·®ç•°
            const lengthPenalty = Math.max(0, clean1.length - clean2.length) * 0.5;
            
            let score = (matchCount / clean2.length) * 100 - lengthPenalty;
            return Math.max(0, Math.min(100, score)); // é™åˆ¶åœ¨ 0-100
        }

    </script>
</body>
</html>

